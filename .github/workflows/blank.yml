name: "Build Export Templates"
on: push

# NOTE: If your `project.godot` is at the repository root, set `PROJECT_PATH` below to ".".

env:
  GODOT_VERSION: 4.3
  PROJECT_PATH: .

jobs:
  build-export-templates:
    name: Build Android Debug
    container: ubuntu:22.04
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: create template
        run: |
          rm -rf templates
          mkdir -p templates
      # Install dependencies
      - name: Install Scons
        run: |
          apt-get update
          apt-get install -y \
              build-essential scons pkg-config libx11-dev libxcursor-dev \
              libxinerama-dev libgl1-mesa-dev libglu-dev libasound2-dev \
              libpulse-dev libudev-dev libxi-dev libxrandr-dev yasm
      - name: Install Godot
        run: |
          git clone https://github.com/godotengine/godot.git
          cd godot
      - name: Windows Template
        run: |
          scons -j 4 p=windows target=release tools=no bits=64
          cp bin/godot.windows.opt.64.exe templates/windows_64_release.exe
          x86_64-w64-mingw32-strip templates/windows_64_release.exe
          scons -j 4 p=windows target=release_debug tools=no bits=64
          cp bin/godot.windows.opt.debug.64.exe templates/windows_64_debug.exe
          x86_64-w64-mingw32-strip templates/windows_64_debug.exe
